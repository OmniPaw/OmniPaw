---
title: Architecture
description: Deep dive into the OmniPaw deterministic kernel and invariant checking logic.
navigation:
  icon: i-lucide-binary
seo:
  title: OmniPaw Architecture
  description: Technical specification for the deterministic execution layer, tick engine, and security invariants.
---

# Architecture

OmniPaw is built as a layered operating system substrate for autonomous agents. Its primary goal is to reach **Deterministic Finality** â€” the guarantee that any execution path can be perfectly reproduced.

## The Layered Kernel

OmniPaw is structured into three primary layers:

1.  **Instruction Layer**: Interprets high-level goals from LLMs and transforms them into discrete kernel instructions.
2.  **Execution Layer (Tick Engine)**: Processes instructions in atomic "ticks". Each tick is isolated and its state transition is hashed.
3.  **Governance Layer (Invariant Checker)**: Monitors every state change against the 15 Core Invariants.

## Deterministic Finality

Determinism is achieved through **State Hashing**. Every time an agent mutates memory or calls a tool, the kernel generates a SHA-256 signature of the delta.

```text
State[N] + Instruction -> State[N+1] + Hash[N+1]
```

These hashes are stored in an immutable Write-Ahead Log (WAL). During **Replay Mode**, the kernel compares the re-computed hashes against the WAL. If they mismatch, it indicates a "Trace Divergence," and the kernel halts to prevent state corruption.

## The 15 Core Invariants

The kernel strictly enforces these rules at runtime:

| ID | Name | Description |
| :--- | :--- | :--- |
| **INV-01** | Instruction Integrity | Instructions cannot be modified once queued. |
| **INV-03** | SharedStore Isolation | Denies access to shared memory without explicit PermissionGrant. |
| **INV-07** | Tick Atomicity | A tick must either complete fully or roll back completely. |
| **INV-09** | Zombie Prevention | Terminated agents cannot execute ticks or mutate state. |
| **INV-15** | Replay Parity | Replay sequences must identically reproduce Live signatures. |

## Observability Stack

OmniPaw natively exports system metrics and agent traces using **OpenTelemetry**. This allows developers to visualize agent decision-making in real-time using tools like Jaeger or the built-in Terminal UI.

### Key Metrics
- `kernel.tick.latency`: Time taken to process one execution round.
- `agent.memory.delta`: Byte-size of state mutations per tick.
- `tool.execution.status`: Success/Failure rates of sandboxed tools.

Next: Learn about [Swarm Coordination](/en/getting-started/project-structure#swarm-coordination).
