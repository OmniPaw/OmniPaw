---
title: Sandboxing Layers
description: Deep dive into L1, L2, and L3 isolation for OmniPaw tools.
navigation:
  icon: i-lucide-layers
seo:
  title: OmniPaw - Sandboxing Layers
  description: Technical breakdown of process, filesystem, and container isolation.
---

# Sandboxing Layers

OmniPaw employs **Progressive Isolation**. Not every tool requires a full Docker container, but every tool must be isolated. The kernel supports three distinct layers of sandboxing depending on the risk profile of the tool.

## L1: Standard Process Isolation

Used for **Pure Logic Tools** (e.g., unit converters, string formatters). These tools run in a separate Node.js child process but share the host's filesystem (though strictly read-only).

- **Benefit**: Extremely low latency.
- **Risk**: Potential for escaping via Node.js native vulnerabilities.

## L2: Chroot / Jail Isolation

Used for **Filesystem Tools** (e.g., reading logs, writing temp files). The kernel creates a virtual "root" directory for the tool. The tool literally cannot "see" files outside this folder.

- **Implementation**: Uses `chroot` (on Linux) or a virtual root mapping (on Windows).
- **Benefit**: Protects sensitive system files (e.g., `.env`, `id_rsa`).

## L3: Docker Container Isolation

The "Gold Standard" for **High-Risk Tools** (e.g., `bash`, `python`, `pip`, `curl`). Every tool call spawns an ephemeral Docker container using the `omnipaw/tool-sandbox` image.

### Why L3?

- **Total Isolation**: Even if the tool gains "root" inside the container, it remains trapped within the virtualized OS.
- **Ephemeral State**: The container is destroyed as soon as the tool returns, ensuring no malicious persistent files are left behind.
- **Network Gating**: Outbound traffic is disabled by default unless the agent has an explicit `PermissionGrant` for network access.

## Configuring a Tool's Sandbox Layer

You can specify the isolation layer during tool registration:

```typescript
const bashTool = new IsolatedTool({
  name: "bash",
  isolation: "L3_DOCKER", // Forces Docker sandbox
});
```

## Security Metrics in OpenTelemetry

Sandboxing events are tracked in the [Telemetry Explorer](/en/ai/agent-substrate). Every time a tool is "gated" or a container is destroyed, a span is exported with the exact `sandbox_id`.

Next: Return to [AI Architecture](/en/ai/agent-substrate).
